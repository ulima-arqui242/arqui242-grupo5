# Pruebas de Penetración (Pentesting)

## Desarrollo Conceptual

### ¿Qué es el Pentesting?
El pentesting, o pruebas de penetración, es un proceso de evaluación de seguridad que implica simular ciberataques controlados para identificar vulnerabilidades en sistemas, redes y aplicaciones. Su objetivo es evaluar la robustez de las medidas de seguridad implementadas y determinar si un atacante podría explotarlas.

### ¿Para qué sirve?
- **Identificar vulnerabilidades**: Permite descubrir brechas de seguridad antes de que puedan ser explotadas.
- **Evaluar la efectividad de las medidas de seguridad**: Garantiza que los mecanismos de protección sean adecuados.
- **Cumplir normativas**: Muchas normativas de seguridad requieren pruebas periódicas de penetración como parte de las auditorías.
- **Proteger información sensible**: Reduce el riesgo de fugas de datos o accesos no autorizados.

### ¿Por qué es importante?
El pentesting es crucial para minimizar riesgos de ciberataques que podrían comprometer datos, servicios, e incluso la reputación de una organización. Además, permite priorizar los esfuerzos de remediación y fortalecer la postura de seguridad de manera proactiva.

## Tecnologías/Programas Utilizados en Pentesting

### 1. **Kali Linux**
- **Descripción**: Distribución de Linux diseñada para pruebas de seguridad. Incluye herramientas para escaneo, explotación, y análisis forense.
- **Ventajas**:
  - Amplia variedad de herramientas preinstaladas.
  - Comunidad activa y documentación extensa.
  - Compatible con múltiples plataformas.
- **Desventajas**:
  - Requiere experiencia técnica para su uso efectivo.
  - Puede ser excesivamente avanzada para principiantes.

### 2. **Burp Suite**
- **Descripción**: Herramienta enfocada en pruebas de seguridad para aplicaciones web. Facilita análisis dinámico y descubrimiento de vulnerabilidades.
- **Ventajas**:
  - Interfaz intuitiva.
  - Automatización de pruebas comunes.
  - Funcionalidades avanzadas en su versión paga.
- **Desventajas**:
  - La versión gratuita tiene limitaciones.
  - No incluye herramientas para análisis de redes.

### 3. **Metasploit**
- **Descripción**: Framework utilizado para explotación de vulnerabilidades y desarrollo de payloads personalizados.
- **Ventajas**:
  - Actualización constante de módulos de ataque.
  - Gran flexibilidad para personalizar exploits.
  - Integración con otras herramientas.
- **Desventajas**:
  - Puede ser complejo para usuarios sin experiencia.
  - Alto potencial de daño si se usa indebidamente.

## Casos de Uso

### ¿Cuándo usar Pentesting?
1. **Antes de lanzar nuevos sistemas o aplicaciones**:
   - Para garantizar que no existan vulnerabilidades críticas en ambientes de producción.
2. **Evaluaciones regulares de seguridad**:
   - Ideal para organizaciones que manejan información sensible o que deben cumplir normativas como ISO 27001 o PCI DSS.
3. **Después de incidentes de seguridad**:
   - Para identificar brechas explotadas y prevenir ataques similares en el futuro.

### Condiciones necesarias para el Pentesting
- **Permiso explícito**: Es fundamental contar con la autorización escrita de la organización para evitar conflictos legales.
- **Definición de alcance**: Establecer claramente los sistemas, redes y aplicaciones a evaluar.
- **Plan de pruebas**: Incluir metodologías reconocidas como OWASP, NIST SP800-115, o PTES.
- **Ambiente controlado**: Realizar las pruebas en horarios planificados para minimizar interrupciones.

## Demo: Accediendo a la Base de Datos de OWASP Juice Shop mediante SQL Injection

### Descripción de la Demo
En esta demo, exploraremos cómo utilizar herramientas comunes en pruebas de penetración, como **Kali Linux**, **Burp Suite**, y **SQLMap**, para explotar una vulnerabilidad de inyección SQL en la aplicación vulnerable **OWASP Juice Shop**. El objetivo será acceder a la base de datos de la aplicación y extraer información sensible como usuarios y contraseñas. Este proceso ilustrará los riesgos asociados con la falta de validación de entradas en aplicaciones web.

---

### Requisitos

1. **Software necesario**:
   - Oracle VirtualBox (para virtualización).
   - Kali Linux (herramienta principal para pentesting).
   - Firefox (navegador web configurado para usar Burp Suite como proxy).
   - Node.js (para ejecutar OWASP Juice Shop).
   - OWASP Juice Shop (aplicación vulnerable para prácticas de pentesting).

2. **Conexión a Internet** para descargar e instalar las herramientas necesarias.

---

## Pasos para la Configuración

### 1. Descargar e Instalar Oracle VirtualBox
1. Accede a la página oficial de [VirtualBox](https://www.virtualbox.org/).
2. Descarga la versión correspondiente a tu sistema operativo.
3. Instala VirtualBox siguiendo las instrucciones de instalación.

### 2. Descargar e Instalar Kali Linux
1. Ve al sitio oficial de [Kali Linux](https://www.kali.org/get-kali/).
2. Descarga la versión "Installer Images".
3. Abrir VirtualBox y crear una nueva máquina virtual
 - **Nombre y Sistema Operativo**
   - Nombre: Kali Linux
   - Tipo: Linux
   - Subtipo: Debian
 - **Hardware**
   - Memoria base: 1/2 de RAM disponible.
   - Procesadores: 1/3 de CPUs disponibles.
 - **Disco Duro**
   - Alocar al menos 30 GB.

### 3. Configurar Máquina Virtual (Opcional)
1. Abrir **Configuración** de la máquina virtual.
 - **General**
   - **Avanzado**
     - Portapapeles compartido: Bidireccional
 - **Pantalla**
   - Memoria de video: 128 MB
   - Características extendidas: Habilitar aceleración 3D
2. Seleccionar **Almacenamiento** y seleccionar el disco "Vacio" en Controlador: IDE dentro de Dispositivos.
3. En **Atributos**, dar click al icono de disco y seleccionar la opción "Choose a Disk File".
4. Selecionar imagen ISO de Kali Linux.

### 4. Configurar Kali Linux
1. Inicia la máquina virtual de Kali Linux.
2. Cuando el menu de instalación cargue, seleccionar "Graphical Install".
3. Seleccionar idioma del sistema a "Spanish".
4. Selecionar locación a "Perú".
5. Seleccionar idioma del teclado a "Latinoamerica".
6. Dejar "hostname" como kali.
7. Dejar "domain name" en vacio.
8. Escribir nombre y apellido del usuario.
9. Escribir nombre de usuario.
10. Escribir contraseña.
11. En la partición del disco, seleccionar "Guiado - utilizar todo el disco".
12. Selecionar "Todos los ficheros en una partición".
13. Selecionar "Finalizar el particionado y escribir los cambios en el disco".
14. Selecionar "Si" para guardar escribir los cambios.
15. Selecionar "GNOME" y deseleccionar "Xfce".
16. Selecionar "Si" para instalar GRUB.
17. Selecionar dispositivo creado para GRUB, comienza con /dev/.
18. Instalación completada.

### 5. Descargar e Instalar Node JS
1. Abrir terminal de Linux.
2. Ingresar los siguientes comandos.
   
   ``` 
   > curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.0/install.sh | bash
   > nvm install 22 
   ```

### 6. Descargar OWASP Juice Shop
1. Ingresar y descargar la última [versión del proyecto](https://github.com/juice-shop/juice-shop/releases/tag/v17.1.1), el archivo es **juice-shop-17.1.1_node22_linux_x64.tgz**. El comando y la versión a descargar pueden cambiar de acuerdo del momento que se realice esta demo.
2. Descomprimir .tgz

   ```
   > cd Downloads
   > sudo tar -xvf juice-shop-17.1.1_node22_linux_x64.tgz
   ``` 

### 7. Configurar BurpSuite
1. Abrir **BurpSuite** y **Firefox**, ambos programas ya vienen preinstaldos de Kali.
2. Entrar a la pestaña de "Proxy" en **BurpSuite**, luego a las Opciones.
 - Anotar la IP y Puerto descrito en **Proxy Listeners**, por defecto es **127.0.0.1:8080**.
3. En **FireFox**, ir a **Settings** y a **Network Settings**.
 - Selecionar "Manual proxy configuration".
 - HTTP Proxy: 127.0.0.1
 - Port: 8080
4. Reiniciar **FireFox**.
5. Abrir **FireFox** y buscar "about:config".
6. En el recuadro de búsqueda de la página, buscar "network.prox.allow_hijacking_localhost" y darle doble click para cambiar su valor a "true".
7. Reiniciar **FireFox**.

---

## Pasos para la Ejecución

### Ejecutar OWASP Juice Shop
1. Abrir terminal de Linux.

   ```
   > cd Downloads
   > cd juice-shop_17.1.1
   > npm start
   ```
2. Si no funciona, entrar como super usuario.

   ```
   > sudo passwd
   -> Ingrear nueva contraseña
   > su
   -> Ingresar contraseña
   > apt update
   > apt install nodejs npm
   > npm start
   ```

## Link Demo
 - **https://youtu.be/fUoGSEAL-6A**

## Fuentes
1. OWASP Foundation. (n.d.). [OWASP Testing Guide](https://owasp.org/www-project-testing/).
2. Offensive Security. (n.d.). [Kali Linux Documentation](https://www.kali.org/docs/).
3. PortSwigger. (n.d.). [Burp Suite Documentation](https://portswigger.net/burp/documentation).
4. Rapid7. (n.d.). [Metasploit Documentation](https://www.rapid7.com/products/metasploit/).

