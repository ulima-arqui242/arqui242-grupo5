# 4.1. Disponibilidad
## Modulo de Itinerario

### Escenario 1
Consideremos el siguiente escenario para Turi

| **Cod Escenario** | **Atributo de Calidad** | **Estímulo**                           | **Fuente del Estímulo** | **Artefacto**                  | **Entorno**                         | **Respuesta**                                                | **Medida de Respuesta**                             |
|------------------|-------------------------|----------------------------------------|-------------------------|--------------------------------|-------------------------------------|-------------------------------------------------------------|-----------------------------------------------------|
| ITN-01           | Disponibilidad           | Fallo en el servidor de base de datos  | Servidor de la nube      | Módulo de Itinerario Personalizable | Operación en horario laboral                | El sistema cambia a un servidor de respaldo   | El sistema mantiene una disponibilidad del 99.9% anual |


### Táctica Elegida
En este caso, para poder llegar a los niveles de respuesta deseados según el escenario (99.9% anual) se está eligiendo la táctica de Redundancia Pasiva. A continuación documentamos los detalles de la decisión.

### Documentación de la Decisión (ADR)

**Título**:  
- Elección entre Redundancia Pasiva vs Redundancia Activa para el Módulo de Itinerario Personalizable.

**Contexto**:  
- El módulo de itinerario maneja datos que los usuarios necesitan de forma constante para planificar sus viajes. Si el servidor de la base de datos falla, los usuarios no podrán acceder a su itinerario. Como la planificación de viajes no es una tarea crítica en tiempo real, tolera tiempos de recuperación breves, por lo que es viable implementar una redundancia pasiva.

**Alternativas**:
1. **Redundancia Pasiva**  
   - Se mantiene un servidor de respaldo actualizado periódicamente. Si el servidor principal falla, el servidor de respaldo se activa para continuar las operaciones.
   - Menor costo operativo, aunque tiene tiempos de conmutación más largos (comparado con la redundancia activa).
   - Adecuado para escenarios donde el tiempo de recuperación no afecta gravemente la experiencia del usuario.

2. **Redundancia Pasiva**  
   - Varios servidores están activos y procesan las solicitudes en paralelo. Si uno falla, otro asume las tareas automáticamente sin interrupciones.
   - Requiere mayor inversión en infraestructura y monitoreo constante, lo cual puede no ser necesario para un módulo no crítico como el de itinerarios.

**Criterios de Elección**:  
- Costo de operación.
- Importancia del tiempo de inactividad.
- Impacto en la experiencia del usuario.
- Frecuencia de cambios y actualizaciones en el servidor de respaldo.

**Decisión**:  
- Se elige la **Redundancia Pasiva**.

**Sustento**:  
- Dado que el módulo de itinerarios personalizables no maneja información crítica en tiempo real, la redundancia pasiva es una opción más costo-eficiente que la redundancia activa. Los tiempos de conmutación de esta táctica son aceptables para la planificación de viajes, y su implementación es menos compleja, lo que la hace ideal para este caso. A pesar de que la redundancia activa proporciona conmutación instantánea, el costo adicional no está justificado dado el contexto del sistema.

### Escenario 2
Consideremos el siguiente escenario para Turi

| **Cod Escenario** | **Atributo de Calidad** | **Estímulo**                           | **Fuente del Estímulo** | **Artefacto**                  | **Entorno**                         | **Respuesta**                                                | **Medida de Respuesta**                             |
|------------------|-------------------------|----------------------------------------|-------------------------|--------------------------------|-------------------------------------|-------------------------------------------------------------|-----------------------------------------------------|
| ITN-02           | Disponibilidad           | Fallo en la conexión a la API de recomendaciones  | Servicio externo      | Módulo de Itinerario Personalizable | Operación normal                | El sistema debe continuar operando con una copia local de datos hasta que se restablezca la conexión   | El sistema opera en modo degradado por hasta 10 minutos sin interrupción |


### Táctica Elegida
En este caso, para poder llegar a los niveles de respuesta deseados según el escenario (continuar operando con copia local de datos por hasta 10 minutos), se elige la táctica de **Modo Degradado**. A continuación documentamos los detalles de la decisión.

### Documentación de la Decisión (ADR)

**Título**:  
- Elección entre Modo Degradado vs Reintento de Conexión para manejar fallos en la API de recomendaciones.

**Contexto**:  
- El módulo de itinerario personalizable utiliza una API externa para ofrecer recomendaciones de lugares turísticos, restaurantes y actividades basadas en las preferencias del usuario. Sin embargo, si la API no responde o la conexión se pierde temporalmente, los usuarios no podrán obtener las recomendaciones en tiempo real. Para evitar una interrupción en el servicio, se propone utilizar un mecanismo que permita al sistema seguir funcionando con datos en caché mientras la conexión a la API se restablece.

**Alternativas**:
1. **Modo Degradado**  
   - El sistema opera con funcionalidades limitadas mientras la conexión a la API externa se restablece.
   - Se utilizarán datos en caché para proporcionar recomendaciones basadas en consultas anteriores, de modo que los usuarios no perciban una interrupción inmediata en el servicio.
   - Se puede implementar rápidamente, sin necesidad de grandes cambios en la infraestructura, y es útil en casos de fallos temporales.

2. **Reintento de conexion**  
   - El sistema intenta reconectar con la API externa después de un periodo de tiempo determinado. Si la reconexión falla, el sistema continúa intentándolo hasta que se restablezca la conexión.
   - Aunque puede solucionar el problema, los usuarios experimentarán una pérdida temporal del servicio de recomendaciones, lo que puede afectar negativamente su experiencia.
   - Puede generar una mayor carga de red si se realiza demasiados intentos de reconexión, lo cual no es ideal en condiciones de alta demanda.

**Criterios de Elección**:  
- Necesidad de mantener la experiencia del usuario sin interrupciones visibles.
- Costo de implementar una solución que minimice el impacto durante fallos temporales.
- Impacto de la indisponibilidad de las recomendaciones en el resto del servicio.
- Frecuencia estimada de fallos en la API externa.

**Decisión**:  
- Se elige la **Modo Degradado**.

**Sustento**:  
- El modo degradado permite que el sistema siga ofreciendo recomendaciones basadas en datos en caché, garantizando que los usuarios no perciban una interrupción inmediata en su experiencia. Aunque la información puede no estar completamente actualizada, esta táctica proporciona una solución rápida y eficiente mientras la API se restablece. El reintento de conexión constante podría generar frustración en los usuarios debido a las interrupciones percibidas, lo que hace que el modo degradado sea una opción más adecuada para este escenario.

